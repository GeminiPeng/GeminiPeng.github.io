# 数据持久化

标签（空格分隔）： iOS

---

 - 属性列表
 - 数据归档/数据序列化
 - sqlite数据库
 - coreData
 
----------
今天记录一下iOS的几种数据持久化方法,数据层是程序员的核心结构之一,比如数据的请求、解析、缓存、持久化等等。适当的对数据进行持久化存储可以实现应用的离线功能，以此提高用户体验.在iOS开发中，苹果提供了四种持久化方案.这些方案分别包括属性列表plist、数据归档NSKeyedValueArchiver/NSUserDefaults、数据库sqlite和coreData.

----------
###介绍
- 属性列表

属性列表是一种明文的轻量级存储方式，其存储格式有多种，最常规格式为XML格式。在我们创建一个新的项目的时候，Xcode会自动生成一个info.plist文件用来存储项目的部分系统设置。plist只能用数组NSArray或者字典NSDictionary进行读取，由于属性列表本身不加密，所以安全性几乎可以说为零。因为，属性列表正常用于存储少量的并且不重要的数据。

在程序启动后，系统会自动创建一个NSUserDefaults的单例对象，我们可以获取这个单例来存储少量的数据，它会将输出存储在.plist格式的文件中。其优点是像字典一样的赋值方式方便简单，但缺点是无法存储自定义的数据。

 - 数据归档/序列化

与属性列表相反，同样作为轻量级存储的持久化方案，数据归档是进行加密处理的，数据在经过归档处理会转换成二进制数据，所以安全性要远远高于属性列表。另外使用归档方式，我们可以将复杂的对象写入文件中，并且不管添加多少对象，将对象写入磁盘的方式都是一样的。

使用NSKeyedArchiver对自定义的数据进行序列化，并且保存在沙盒目录下。使用这种归档的前提是让存储的数据模型遵守NSCoding协议并且实现其两个协议方法。（当然，如果为了更加安全的存储，也可以遵守NSSecureCoding协议，这是iOS6之后新增的特性）

 - 数据库
 
sqlite是一个轻量级、跨平台的小型数据库，其拥有可移植性高、有着和MySql几乎相同的数据库语句以及无需服务器即可使用的优点：

> 可以存储大量的数据，存储和检索的速度非常快；
能对数据进行大量的聚合，这样比起使用对象来进行这些操作要快。

当然，它也具有明显的缺点：

> 它没有提供数据库的创建方式；
它基于C语言框架设计，没有面向对象的API，所以使用起来比较麻烦；
复杂的数据模型的数据建表相对而言比较麻烦。

当然，我们也可以使用基于sqlite封装的开源数据库FMDB来减少使用sqlite的工作量

 - coreData

`coreData`是苹果官方iOS5之后推出的综合型数据库，其使用了`ORM(Object Relational Mapping)`对象关系映射技术，将对象转换成数据，存储在本地数据库中。coreData为了提高效率，甚至将数据存储在不同的数据库中，且在使用的时候将本地数据放到内存中使得访问速度更快。我们可以选择coreData的数据存储方式，包括`sqlite、xml`等格式。但也正是`coreData`是完全面向对象的，其在执行效率上比不上原生的数据库。除此之外，`coreData`拥有数据验证、`undo`等其他功能，在功能上是四种持久化方案最多的。


----------


##属性列表

 
